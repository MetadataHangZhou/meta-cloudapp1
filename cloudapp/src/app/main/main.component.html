<section>
    <h1>
        Welcome!
    </h1>
    <p>Use this sample app to get you started. The app includes the following:</p>
    <ul>
        <li>Listener for the <code>onPageLoad</code> event</li>
        <li>Performs an API call using the <code>restService</code> service</li>
        <li>Updates the object using the <code>restService</code> service</li>
        <li>Refreshes the page in Alma</li>
    </ul>
    <p>Use these building blocks to be on your way to developing your own Cloud App.</p>
</section>
<section *ngIf="!show">
    <button mat-raised-button color="primary" (click)="showConfig()"
    >{{'i18n.Config'|translate}}</button>
</section>
<section *ngIf="show">
    <mat-card class="example-card">
        <mat-card-header>
            <mat-card-title>{{'i18n.Config'|translate}}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <mat-form-field class="example-full-width">
                <mat-label>{{'i18n.UserCode'|translate}}</mat-label>
                <input matInput [(ngModel)]="settings.institution">
            </mat-form-field>
            <mat-form-field class="example-full-width">
                <mat-label>{{'i18n.UserCodefile'|translate}}</mat-label>
                <input matInput [(ngModel)]="settings.institutionType">
            </mat-form-field>
            <mat-form-field class="example-full-width">
                <mat-label>{{'i18n.Collectionfield'|translate}}</mat-label>
                <input matInput [(ngModel)]="settings.holding">
            </mat-form-field>
            <mat-form-field class="example-full-width">
                <mat-label>{{'i18n.CallNumberEnquiry'|translate}}</mat-label>
                <input matInput [(ngModel)]="settings.lookupUrl">
            </mat-form-field>
            <mat-form-field class="example-full-width">
                <mat-label>{{'i18n.CallNumberQueryType'|translate}}</mat-label>
                <input matInput [(ngModel)]="settings.lookupPrefix">
            </mat-form-field>
            <mat-form-field class="example-full-width">
                <mat-label>{{'i18n.ClassificationNumberSubfield'|translate}}</mat-label>
                <input matInput [(ngModel)]="settings.classificationNumber">
            </mat-form-field>
            <mat-form-field class="example-full-width">
                <mat-label>{{'i18n.SubfieldOfSpeciesNumber'|translate}}</mat-label>
                <input matInput [(ngModel)]="settings.titleNumber">
            </mat-form-field>
            <mat-form-field class="example-full-width">
                <mat-label>{{'i18n.CallNumberSubfield'|translate}}</mat-label>
                <input matInput [(ngModel)]="settings.callNo">
            </mat-form-field>
        </mat-card-content>
    </mat-card>
</section>
<section>
    <mat-card class="example-card" *ngIf="false">
        <mat-card-header>
            <mat-card-title>Page Entity</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <pre>{{ pageEntities | json }}</pre>
        </mat-card-content>
    </mat-card>
</section>
<section>
        <button mat-raised-button color="primary" (click)="setSettings(false)" [disabled]="!hasApiResult || loading"
        >{{'i18n.Rebuild'|translate}}</button>
        <button mat-raised-button color="primary" (click)="setSettings(true)" [disabled]="!hasApiResult || loading"
        >{{'i18n.Update'|translate}}</button>
    <mat-card class="example-card" >
        <mat-card-header>
            <mat-card-title>API Result</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <textarea #apiResultArea [value]="apiResult | json"></textarea>
        </mat-card-content>
        <mat-card-actions>
            <button mat-raised-button color="primary" (click)="update(apiResultArea.value)"
                    [disabled]="!hasApiResult || loading">重新生成
            </button>
            <button mat-raised-button color="primary" (click)="update(apiResultArea.value)"
                    [disabled]="!hasApiResult || loading">更新
            </button>
        </mat-card-actions>
    </mat-card>
</section>
<div class="loading-shade" *ngIf="loading">
    <mat-spinner diameter="50"></mat-spinner>
</div>
